			var musicList = [
				{
					title : 'Aimer (エメ) - 六等星の夜 (六等星之夜)',  //歌名
					singer : 'Aimer (エメ);',   						//歌手
					cover  : 'yingyueing/动漫/Aimer(エメ);.jpg',      // 歌手图片
					src    : 'MP3/Aimer (エメ) - 六等星の夜 (六等星之夜).mp3',   // 歌曲地址
					gecis   :  'lrc/Aimer (エメ) - 六等星の夜 (六等星之夜).lrc',   // 歌词地址
					leix    : '动漫',           								//类型
					yuzho   : '日语',										//语种
				},
					
				{
					title : '40㍍P - からくりピエロ (活动小丑)',
					singer : '40㍍P;',
					cover  : 'yingyueing/动漫/40㍍P;.jpg',
					src    : 'MP3/40㍍P - からくりピエロ (活动小丑).mp3',
					gecis   :  'lrc/40㍍P - からくりピエロ (活动小丑).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},	
				{
					title : '7!! (Seven Oops) - ReReハロ~終われそうにない夏~ (ReRe Hello~不会结束的夏天~)',
					singer : '7!! (Seven Oops)',
					cover  : 'yingyueing/动漫/7!!.jpg',
					src    : 'MP3/7!! (Seven Oops) - ReReハロ~終われそうにない夏~ (ReRe Hello~不会结束的夏天~).mp3',
					gecis   :  'lrc/7!! (Seven Oops) - ReReハロ~終われそうにない夏~ (ReRe Hello~不会结束的夏天~).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				{
					title : '7!! (Seven Oops) - オレンジ (Orange)',
					singer : '7!! (Seven Oops)',
					cover  : 'yingyueing/动漫/7!!.jpg',
					src    : 'MP3/7!! (Seven Oops) - オレンジ (Orange).mp3',
					gecis   :  'lrc/7!! (Seven Oops) - オレンジ (Orange).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				{
					title : 'acane_madder (アカネマダー) - 庭園にて。 (在庭院中)',
					singer : 'acane_madder (アカネマダー) ',
					cover  : 'yingyueing/动漫/acane_madder(アカネマダー).jpg',
					src    : 'MP3/acane_madder (アカネマダー) - 庭園にて。 (在庭院中).mp3',
					gecis   :  'lrc/acane_madder (アカネマダー) - 庭園にて。 (在庭院中).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				
				{
					title : 'Aimee Blackschleger - Release My Soul (释放我的灵魂)',
					singer : 'Aimee',
					cover  : 'yingyueing/动漫/1.jpg',
					src    : 'MP3/Aimee Blackschleger - Release My Soul (释放我的灵魂).mp3',
					gecis   :  'lrc/Aimee Blackschleger - Release My Soul (释放我的灵魂).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				
				{
					title : 'Aimer (エメ) - LAST STARDUST',
					singer : 'Aimer (エメ)',
					cover  : 'yingyueing/动漫/Aimer.jpg',
					src    : 'MP3/Aimer (エメ) - LAST STARDUST.mp3',
					gecis   :  'lrc/Aimer (エメ) - LAST STARDUST.lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				{
					title : 'angela (アンジェラ) - 冷たい部屋、一人 (冰冷的房间 一个人)',
					singer : 'angela (アンジェラ)',
					cover  : 'yingyueing/动漫/angela(アンジェラ).jpg',
					src    : 'MP3/angela (アンジェラ) - 冷たい部屋、一人 (冰冷的房间 一个人).mp3',
					gecis   :  'lrc/angela (アンジェラ) - 冷たい部屋、一人 (冰冷的房间 一个人).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				{
					title : 'Aqua Timez (アクア タイムズ) - 真夜中のオーケストラ (午夜交响曲)',
					singer : 'Aqua Timez (アクア タイムズ)',
					cover  : 'yingyueing/动漫/AquaTimez.jpg',
					src    : 'MP3/Aqua Timez (アクア タイムズ) - 真夜中のオーケストラ (午夜交响曲).mp3',
					gecis   :  'lrc/Aqua Timez (アクア タイムズ) - 真夜中のオーケストラ (午夜交响曲).lrc',
					leix    : '动漫',
					yuzho   : '日语',
				},
				{
					title : '许嵩 - 爱情里的眼泪',
					singer : '许嵩',
					cover  : 'MP3/许嵩/许嵩.jpg',
					src    : 'MP3/许嵩/许嵩 - 爱情里的眼泪.mp3',
					gecis   : 'MP3/许嵩/lrc/许嵩 - 爱情里的眼泪.lrc',
					leix    : '伤感',
					yuzho   : '华语',
				},
				{
					title : '许嵩 - 安徒生不后悔',
					singer : '许嵩',
					cover  : 'MP3/许嵩/许嵩.jpg',
					src    : 'MP3/许嵩/许嵩 - 安徒生不后悔.mp3',
					gecis   : 'MP3/许嵩/lrc/许嵩 - 安徒生不后悔.lrc',
					leix    : '伤感',
					yuzho   : '华语',
				},
			];
			//保存颜色的数组
			var aee=["red","cyan","green","blue","orange","purple","#557CC1","#DA63FF","#93F100","#FECCE5"];
			//加载歌曲目录
			function fun(){
				for(var i=0;i<musicList.length;i++){
					var text=`<p onclick="fun1('${musicList[i].title}')">${musicList[i].title}</p>`;
					$(".e").append(text);
				}
			};
			fun();
			raised();
			 var music = document.getElementById("data5");  // 获得音乐对象\
			//根据歌名更改歌曲
			 function fun1(object){
				for(var a=0;a<musicList.length;a++){
					if(musicList[a].title==object){
						music.pause();     //停止
						document.getElementById("data4").src=musicList[a].src;
						music.load();   //重新加载
						document.getElementById("data1").innerText=musicList[a].title;   //歌曲名
						document.getElementById("data2").innerText=musicList[a].singer;    //歌手
						$("#img").attr("src",musicList[a].cover);
						$("#lrcs").attr("src",musicList[a].gecis);
						fun3();
				        music.play();
					}
				}
			};
			//如果播放完了就直接跳到下一首
			function  finish(){   //监听这个事件
				var name=document.getElementById("data1").innerText;   //获取当前歌曲名字
				if(music.currentTime>music.duration-3){
					for(var i=0;i<musicList.length;i++){
						if(name==musicList[i].title){
							var d=i+1;
							if(i==musicList.length){
								d=0;
							}
							var newName=musicList[d].title;
							fun1(newName);
						}
					}	
				}
			};
			
			
			
			
		//下面的是歌词的同步和滚动效果
		var lrc=[]; //保存歌词的数组
		var dates=[]; //保存时间的数组
		function fun2(){
			lrc=[]; //保存歌词的数组清空
			dates=[];//保存时间的数组清空
			$("#lyric .geul").empty();
			var sj=document.getElementById("lrcs");   //获取文件的对象
			var arr= document.getElementById('lrcs').contentWindow.document.body.innerHTML;  //获取文件里面的内容
			var fg=arr.split("[");//按行来分割       
			var pattern=/\d{2}:\d{2}.\d{2}\]/g;
			for(var a=0;a<fg.length;a++){
				if(pattern.test(fg[a])){  //剔除没有时间的句子
					var geci=fg[a].replace(pattern,"");//获取到歌词
					var times=fg[a].split("]")[0];//获取到时间
					var fen=times.split(':')[0];   //时间格式为[xx:xx.xx] 所以要将其变成秒数  先通过：分割
					var miao= times.split(':')[1];
					var newtime=parseInt(fen*60) + parseFloat(miao);//最后的毫秒数
					dates.push(newtime);//保存到时间数组
					lrc.push(geci); //保存到歌词数组
				}
			}
			for (var b=0;b<dates.length;b++) {
				var txt1='<li>'+lrc[b]+'</li>';
				$("#lyric .geul").append(txt1); 
			}
			var music = document.getElementById("data5");  // 获得音乐对象
				music.ontimeupdate = function(){
					fun3();
					finish();
					if(music.currentTime<=1){
						$("#lyric .geul").empty();
						$('#lyric .geul').css('margin-top',0+'px');
						for (var b=0;b<dates.length;b++) {
							var txt1='<li>'+lrc[b]+'</li>';
							$("#lyric .geul").append(txt1); 
						}
					}
					var count=0;
					for (var b=0;b<dates.length;b++) {
						if(music.currentTime>dates[b]){
							if(b>=10){
								 count=b-9;
								 $('#lyric .geul').css('margin-top',-count*21+'px'); //让歌词向上移动
							}
							 $('#lyric .geul li').css('color','');//将播放过的歌词还原颜色    
							 $('#lyric .geul li').css('background-color','');//将播放过的歌词还原颜色    
							 $('#lyric .geul li:nth-child('+(b+1)+')').css('color','blue'); //高亮显示当前播放的哪一句歌词 
							 $('#lyric .geul li:nth-child('+(b+1)+')').css('background-color','#F1EFEC'); //高亮显示当前播放的哪一句歌词 
						}
					}
				}
		};
		function fun3(){
			lrc=[]; //保存歌词的数组清空
			dates=[];//保存时间的数组清空
			$("#lyric .geul li").empty();//清除li里面的数据
			fun2();//重新写入数据
		};
		

	   // 歌词的显示和隐藏
	   $("#bk .a #liu").click(function(){
	   		fun3();
	   		$("#lyric").toggle();
	   		$("#lyric").animate({height:'490px', width:'490px' });
	   		$("#bk").animate({left:'170px' });
	   		if($("#lyric").is(":hidden")){
	   			$("#lyric").animate({height:'50px', width:'50px' });
	   			$("#bk").animate({left:'350px' });
	   		}
	   	
	   });



		//音频的波浪纹
		function raised(){
			    var wrap = document.getElementById("wrap");
			    var cxt = wrap.getContext("2d");
			    //获取API
			    var context = new AudioContext;
			    //加载媒体
			    /*var audio = new Audio("MP3/40㍍P - からくりピエロ (活动小丑).mp3");*/
			    var audio =document.getElementById("data5");;
			    //创建节点
			    var source = context.createMediaElementSource(audio);
			    var analyser = context.createAnalyser();
			    //连接：source → analyser → destination
			    source.connect(analyser);
			    analyser.connect(context.destination);
			    //创建数据
			    var output = new Uint8Array(100);
			    (function drawSpectrum() {
			        analyser.getByteFrequencyData(output);//获取频域数据
			        cxt.clearRect(0, 0, wrap.width, wrap.height);
			        //画线条
			        /*var p2=Math.random()*10;    //获取随机数对应颜色
					var n=Math.ceil(p2);*/
			        for (var i = 0; i < 100; i++) {
			        	var t=i%10;
			            var value = output[i] / 8;//<===获取数据
			            var heights=wrap.height-(value*2);
			            cxt.fillStyle=aee[t];  //定义颜色
			            cxt.fillRect(i*5,heights,4,value*2);
			        }
			        //请求下一帧
			        requestAnimationFrame(drawSpectrum);
			    })();
		}
	
		//视频的显示隐藏
		$("#qiehuan").click(function(){
			$("#videos").show();
			music.pause();
		});
		
		var data=new Array(); //保存数据
  		var date;   //记录当前播放的时间
  		var vids = document.getElementById("yp");  // 获得视频对象\
		var volume=0;
		
		
		
		//音量的控制
		$("#ranges").change(function(){
			var volume=$("#ranges").val();
			vids.volume = volume/100; 
		})
		
		//加速播放
		var count=1;
		$("#upx").click(function(){
			count++;
			if(count>8){
				count=1;
			}
			vids.playbackRate=count;
			$("#upx").text("x"+count);
		})
		
		//视频的显示隐藏切换到音乐播放器
		$("#qh").click(function(){
			$("#videos").hide();
			music.pause();
		});
		//弹幕的关闭
		$("#close").click(function(){
			$("#tm").toggle();
		})
		
		//发送弹幕保存
		$("#form").submit(function(e){
			date=Math.ceil(vids.currentTime+1);  //当前播放的时间
			var text=$("#text").val();	
			var colors=$("#colors").val();	
			var newData={
				texts:text,
				dates:date,
				color:colors
			}
			data.push(newData);
			e.stopPropagation();
			return false;
		});

		var pd=true;
		setInterval(function(){
			for (var i=0;i<data.length;i++) {
				if(Math.ceil(vids.currentTime)==data[i].dates){
					var p=Math.random()*420;    //获取随机数位置
					$("#tm").append('<samp class=_'+i+' style="margin-top:'+p+'px">'+data[i].texts+'</samp>');
					$("._"+i+"").css("color",data[i].color); //字体颜色
				}	
			}
			if(pd){
				for (var i=0;i<data.length;i++) {
					$("._"+i+"").animate({left: '-1000px'},30000); 
				}
			}else{
				$("samp").stop();
			}
			
		},1000);
		//点击播放或者暂停
		var counts=0;
		$("#tm").click(function(){
			counts++;
			if(counts%2==0){
				vids.pause();
				$("samp").stop();
				pd=false;
			}else{
				vids.play();
				for (var i=0;i<data.length;i++) {
					$("._"+i+"").animate({left: '-1000px'},30000); 
				}
				pd=true;
			}
		})
		